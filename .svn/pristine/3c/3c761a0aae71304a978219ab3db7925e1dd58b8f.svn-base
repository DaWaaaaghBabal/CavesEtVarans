package skills.factory;

import java.io.File;
import java.io.IOException;
import java.net.URL;
import java.util.ArrayList;
import java.util.List;
import java.util.Map;

import org.jdom2.Element;
import org.jdom2.JDOMException;
import org.jdom2.input.SAXBuilder;

import skills.Skill;
import skills.SkillCost;
import skills.SkillEffect;
import skills.SkillHitCondition;
import skills.conditions.Condition_Attack;
import skills.effects.Effect_CriticalDamage;
import skills.effects.Effect_Damage;
import skills.values.StatReader;
import skills.values.ValueCalculator;
import character.GameCharacter;
import character.statistics.Statistic;
import combatTests.RepeatedCombatTest_Selector;

public class SkillFactory {

	public static Skill initAttack(GameCharacter attacker,
			GameCharacter defender) {
		Skill attack = new Skill("Basic Attack");
		attack.setCost(new SkillCost());
		attack.setOwner(attacker);

		RepeatedCombatTest_Selector selector = new RepeatedCombatTest_Selector(
				attack);
		selector.target = defender;
		attack.setTargetSelector(selector);

		SkillHitCondition condition = new Condition_Attack(Statistic.MELEE_ATK,
				Statistic.DEFENCE);
		attack.setHitCondition(condition);

		List<SkillEffect> effects = new ArrayList<SkillEffect>();
		attack.setMissEffects(effects);

		effects = new ArrayList<SkillEffect>();
		ValueCalculator dmgValue = new StatReader("source", Statistic.MELEE_DMG);
		SkillEffect damage = new Effect_Damage(dmgValue, "Physical");
		effects.add(damage);
		attack.setHitEffects(effects);

		effects = new ArrayList<SkillEffect>();
		SkillEffect critical = new Effect_CriticalDamage(dmgValue, "Physical");
		effects.add(critical);
		attack.setCritEffects(effects);
		return attack;
	}

	public static Map<String, Skill> initSkills(String className) {
		// TODO Auto-generated method stub
		URL resource = SkillFactory.class.getResource("/XML/skills/" + className + ".xml");
		System.out.println(resource);
		SAXBuilder sxb = new SAXBuilder();
		try {
			Element root = sxb.build(resource).getRootElement();

		} catch (JDOMException | IOException e) {
			e.printStackTrace();
		}
		return null;
	}

}
